## Flag 1: 

1. Download procmon64.exe from https://live.sysinternals.com/
2. Launch procmon64.exe
3. Add a filter: Process Name contains <nameofmalware>.exe
4. Only "show network activity"
5. Launch the malware
6. See it's localhost:8080
7. Flag: `127.0.0.1:8080`

## Flag 2

1. Install mitmproxy
2. Launch mitmweb: `C:\Program Files\mitmproxy\bin\mitmweb.exe`
3. Execute the malware
4. Look at the request in mitmweb for google.ca and note the URI
5. Flag: `/f60f9bb7f0fa90913ed00422bdc5bc963024003a8a7b09dd8`

## Flag 3
1. In mitmweb, get the certificate: Set your windows proxy to
`http://127.0.0.1:8080` in the "proxy settings" then save
2. In mitmweb: File --> install certificates --> follow instructions
3. If that doesnt work, download cert using this powershell command: `curl http://mitm.it/cert/p12 -UseBasicParsing -Proxy http://127.0.01:8080 -OutFile out.p12`
4. Install the cert in the "Trusted Root Certification Authorities" store.
5. Execute the malware
6. See the https request in mitmweb
7. Flag: `/9ba5e93514b36b13d4d97d3dea0067b043bd4d97d3dea0067b043bd4d97d3dea0067b043bd4d97d3dea0067b043b`

## Flag 4

1. Install wireshark
2. Start a packet capture with all the interfaces listening
3. Filter packets: `http`
4. Execute the malware
5. The last packets should show the C2 Domain
6. Flag: `totallylegitdomain-notevil.cn`


# Flag 5:
1. Add this line to your `C:\Windows\System32\Drivers\etc\hosts` file: `127.0.0.1 totallylegitdomain-notevil.cn`. This ensures requests to the C2 domain will be redirected on the machine.
2. In the mitmweb interface, options --> check `Don't verify server certificates`
3. Generate a self-signed cert for the C2 domain `totallylegitdomain-notevil.cn` here: https://regery.com/en/security/ssl-tools/self-signed-certificate-generator
4. Download the cert and the private key
5. Create an HTTPS web server using python. Example: the `simple_webserver.py` file in this repo.
6. Launch the webserver: `python simple_webserver.py`
7. Execute the malware
8. Look in mitmweb, and see that the requested URI is `/handshaketest`
9. Create a file named `handshaketest` in the same directory with the content: `None`
10. Execute the malware again
11. Look in mitmweb, you should see the flag!
12. Flag: `FLAG-6588ba4c1b32f4f2dc5c0a500311153da500311153dd981841c`

